
# SmartLex - 高端语义分析引擎开发文档

## 1. 项目简介
**SmartLex** 是一款基于 **Doubao (Volcengine)** AI 的深度语义分析工具。它不仅仅是一个翻译器，而是一个“语义实验室”，旨在帮助高级英语学习者、学者和翻译人员拆解单词及短语背后的隐喻逻辑、文化语境和细微差别。

## 2. 技术栈
- **核心框架**: React 19
- **样式引擎**: Tailwind CSS
- **AI 引擎**: **Doubao (Volcengine)** (via `aiService.ts`)
- **持久化层**: `storageService.ts` (混合支持 LocalStorage + Tauri Native FS + Web File System Access API)
- **桌面构建**: Tauri (方案 A)

## 3. 存储系统详解 (重要)
为了实现“数据由用户完全掌控”，项目采用了三级持久化策略：

### A. 用户自选路径 (新增 - Web 端核心功能)
应用利用 **File System Access API** (Chromium 浏览器支持) 允许用户直接在本地磁盘上选择或创建一个 `.lex` 文件作为实时数据库：
- **实时同步**: 一旦建立链接，所有的分析记录、知识库更新都会直接流式写入该本地文件。
- **持久化**: 即使清理浏览器缓存，只要重新链接该文件，数据即可瞬间找回。
- **云同步兼容**: 用户可以将文件保存在 OneDrive、Dropbox 或 iCloud 挂载盘中，实现跨设备同步。

### B. Tauri 原生同步 (桌面端)
当应用在 Tauri 环境运行时：
- **自动持久化**: 会自动在系统的 `AppData` (Win) 或 `Application Support` (Mac) 目录下维护一个 `workspace.lex` 文件。

### C. 离线备份与迁移
- **导出**: 用户可以随时将当前工作空间导出为独立的 `.lex` 文件。
- **导入**: 支持通过上传功能恢复旧的备份文件，实现数据的灵活迁移。

## 4. 迁移到 Tauri 的 Fs 配置
在将项目构建为桌面端时，必须在 `src-tauri/capabilities/default.json` (或 `tauri.conf.json`) 中声明文件权限：

```json
{
  "permissions": [
    "fs:allow-app-data-write",
    "fs:allow-app-data-read",
    "fs:allow-write-text-file",
    "fs:allow-read-text-file"
  ]
}
```

## 5. 核心功能
- **深度分析**: 支持词根识别、语用学分析、Google Search 实证。
- **专注模式**: 隐藏了语音/图片输入及部分高级设置，专注于纯文本的深度语义探索。
- **实时同步**: 顶栏显示同步状态，确保数据“所见即所存”。
- **PDF 导出**: 支持离线生成精美分析报告。


## 6. 版本历史



### v0.1.8 (Current)
- **UX Unification (Neo-Brutalism/Comic Style)**:
  - 全面统一了 Global Shell, Sidebar, AnalysisStation, Library 的视觉风格，采用高对比度边框和硬阴影。
  - 移除了所有 Glassmorphism 效果，确保风格一致性。
- **全面汉化 (Localization)**:
  - 完成了 AnalysisStation, Sidebar, ChatSidebar, Library 的全量汉化。
  - 实现了 Library 中分析类型 (Type) 的中文映射 (如 Metaphor -> 隐喻)。
- **功能增强**:
  - **Bilingual Fun Facts**: 加载界面新增中英双语的语言学冷知识轮播。
  - **Tag 优化**: 调整 AI Prompt，强制生成 1-2 个精准的行业/领域标签 (Sector/Field)，杜绝描述性长句。
- **体验优化**:
  - 精简了 Sidebar 菜单，移除了冗余的 "History" 和重复的 "Settings"。

### v0.1.7
- **UI 布局终级修复**:
  - 修正了主容器的 CSS 层级，强制 `html`, `body`, `#root` 高度为 100% 且 `overflow: hidden`。
  - 应用主容器使用 `h-full` 配合 `min-h-0`，彻底解决 Flexbox 溢出问题。
  - 修复了 `AnalysisStation` 内部缺少的 `overflow-hidden`，防止内容被底部裁剪。

### v0.1.6
- **UI 布局紧急修复**:
  - 修复了主内容区域在部分分辨率下底部被遮挡且无法滚动的问题 (Flexbox min-h-0 fix)。
  - 调整应用高度计算为 `dvh` (Dynamic Viewport Height)，更精准适配视窗。
  - 增强了滚动条的可视性（加宽至 8px 并加深颜色）。

### v0.1.5
- **UI 深度优化**:
  - 全面应用美漫风格 (Comic Style) 到所有分析组件 (语用、语义网络、例句、词源)。
  - 汉化了所有界面元素 (History, Result, Save 按钮及面包屑导航)。
  - 优化了 Chat Sidebar 的输入框布局，修复了发送按钮对齐问题。
  - 为顶部导航栏图标添加了中文悬浮提示。
- **AI 引擎修复**:
  - 修复了 "Failed to fetch" (CORS) 错误，通过 Vite Proxy 转发开发环境请求。
  - 增强了 API Key 的健壮性，自动过滤无效的 LocalStorage 配置。
- **体验改进**:
  - 实现了动态面包屑导航 (根据进入路径显示 "首页" / "历史记录" / "知识库")。
  - 修复了 Library 标题显示 (移除了 VAULT 后缀)。

---
*Generated by SmartLex Development Engine - Storage Strategy v1.1 Updated*
